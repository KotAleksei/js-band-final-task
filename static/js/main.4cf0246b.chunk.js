(this["webpackJsonpjs-band-final-task"]=this["webpackJsonpjs-band-final-task"]||[]).push([[0],{39:function(e,t,a){e.exports=a.p+"static/media/logo-image.22826269.png"},42:function(e,t,a){e.exports=a(73)},70:function(e,t,a){},71:function(e,t,a){},72:function(e,t,a){},73:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(16),c=a.n(o),i=a(24),s=a(11),l=(a(51),a(7));var u=function(){return r.a.createElement("div",null,r.a.createElement("div",{className:"bg-secondary border-bottom "},r.a.createElement("h1",{className:"h2 text-left pt-3 pb-2 pl-5",style:{color:"white"}},"JS BAND STORE/ Aleksei Kotvitskyi")))},m=a(18),d=a(19),b=a(21),p=a(20),h=a(15),f=a(22),E=a(39),g=a.n(E),v=a(13),k=a.n(v);k.a.defaults.baseURL="https://js-band-api.glitch.me/";var y=function(e){return function(t){t({type:"SIGN_IN_REQUEST"}),function(e){return k.a.post("signin",e)}(e).then((function(e){var a=e.data;return t({type:"SIGN_IN_SUCCESS",payload:a})})).catch((function(e){return t({type:"SIGN_IN_ERROR",payload:e})}))}},O=function(e){function t(e){var a;return Object(m.a)(this,t),(a=Object(b.a)(this,Object(p.a)(t).call(this,e))).state={username:""},a.userNameInput=r.a.createRef(),a.handleChange=a.handleChange.bind(Object(h.a)(a)),a.handleSubmit=a.handleSubmit.bind(Object(h.a)(a)),a}return Object(f.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.isAuthentificated,a=e.history,n=this.userNameInput.current;n.addEventListener("invalid",(function(){n.setCustomValidity("Field is not valid")})),t&&a.replace("/books")}},{key:"componentDidUpdate",value:function(){var e=this.props,t=e.isAuthentificated,a=e.history;t&&a.replace("/books")}},{key:"handleChange",value:function(e){var t=e.target.value.length>3;this.setState({username:e.target.value}),t?e.target.setCustomValidity(""):e.target.setCustomValidity("Field is not valid")}},{key:"handleSubmit",value:function(e){e.preventDefault();var t=this.state.username;(0,this.props.signInCT)({username:t})}},{key:"render",value:function(){return r.a.createElement("div",{className:"container d-flex justify-content-center"},r.a.createElement("div",{className:"container col-6 col-lg-4 text-center mt-5"},r.a.createElement("img",{className:"card-img-top rounded col-8",src:g.a,alt:"avatar"}),r.a.createElement("form",{className:"d-flex flex-column align-items-center",onSubmit:this.handleSubmit},r.a.createElement("label",{className:"mt-3 col-11 font-weight-bold"},"Username",r.a.createElement("input",{type:"text",placeholder:"type Username",className:"form-control text-center",minLength:4,maxLength:16,ref:this.userNameInput,autoFocus:!0,required:!0,onChange:this.handleChange})),r.a.createElement("button",{type:"submit",className:"btn btn-success mt-3 col-10 btn-submit"},r.a.createElement("span",{className:"signIn-content"},"Sign-In")))))}}]),t}(r.a.Component),N=Object(s.b)((function(e){return{isAuthentificated:e.signInReducer.isAuthentificated}}),(function(e){return{signInCT:function(t){return e(y(t))}}}))(Object(l.g)(O)),S=function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(u,null),r.a.createElement(N,null))},j=a(2),R=a.n(j);k.a.defaults.baseURL="https://js-band-api.glitch.me/";var I=a(10),C={isAuthentificated:!!localStorage.getItem("token"),error:void 0,avatar:void 0,token:localStorage.getItem("token"),username:void 0},_=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:C,t=arguments.length>1?arguments[1]:void 0,a=t.type;switch(a){case"SIGN_IN_SUCCESS":var n=t.payload,r=n.avatar,o=n.token,c=n.username;return localStorage.setItem("token",o),Object(I.a)({},e,{isAuthentificated:!0,avatar:r,token:o,username:c});case"SIGN_IN_ERROR":var i=t.payload;return Object(I.a)({},e,{error:i.error});default:return e}},L=function(){return function(e,t){var a=t().signInReducer.token;a&&(e({type:"GET_BOOKS_REQUEST"}),function(e){return k.a.get("books",{headers:{Authorization:"Bearer ".concat(e)}})}(a).then((function(t){var a=t.data;return e({type:"GET_BOOKS_SUCCES",payload:a})})).catch((function(t){var a=t.response.data;return e(function(e){return{type:"GET_BOOKS_ERROR",payload:e}}(a))})))}},T=function(e){var t=e.book;return r.a.createElement("li",{className:"card booklist-item bg-light "},r.a.createElement("img",{src:t.cover,alt:t.title,className:"rounded mx-auto d-block book-img"}),r.a.createElement("div",{className:"card-body"},r.a.createElement("h5",{className:"card-title"},t.title),r.a.createElement("p",{className:"card-text"},t.author)),r.a.createElement("div",{className:"card-footer"},r.a.createElement("span",{className:"float-left book-price"},"Price: ",t.price,"$"),r.a.createElement("button",{type:"button",className:"btn btn-dark float-right"},"View")))},x=function(){return r.a.createElement("div",{className:"loader mt-5"},r.a.createElement("div",{className:"spinner-border",role:"status"},r.a.createElement("span",{className:"sr-only"},"Loading...")))},U=function(e){function t(){return Object(m.a)(this,t),Object(b.a)(this,Object(p.a)(t).apply(this,arguments))}return Object(f.a)(t,e),Object(d.a)(t,[{key:"componentDidMount",value:function(){var e=this.props,t=e.books,a=e.getBooksCT;t||a()}},{key:"render",value:function(){var e=this.props,t=e.books,a=e.isLoading,n=e.error;return r.a.createElement(r.a.Fragment,null,a&&r.a.createElement(x,null),n&&r.a.createElement("div",{className:"booklist-erroMessage"},"Oops... You should Authorize"),t&&r.a.createElement("ul",{className:"bookList"},t.map((function(e){return r.a.createElement(T,{key:e.id,book:e})}))))}}]),t}(r.a.Component);U.defaultProps={books:R.a.undefined,error:R.a.undefined};var B=Object(s.b)((function(e){return{books:e.booksReducer.books,isLoading:e.booksReducer.isLoading,error:e.booksReducer.error}}),(function(e){return{getBooksCT:function(){return e(L())}}}))(U),G=function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(u,null),r.a.createElement(B,null))};function A(){return r.a.createElement("h1",null,"Not Found...")}var w=function(){return r.a.createElement(l.d,null,r.a.createElement(l.b,{exact:!0,path:"/"},r.a.createElement(l.a,{to:"/signin"})),r.a.createElement(l.b,{path:"/signin",component:S}),r.a.createElement(l.b,{path:"/books",component:G}),r.a.createElement(l.b,{path:"*",component:A}))},F=(a(70),a(71),a(72),a(12)),K=a(41),D={books:void 0,error:void 0,isLoading:!1},V=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:D,t=arguments.length>1?arguments[1]:void 0,a=t.type;switch(a){case"GET_BOOKS_REQUEST":return Object(I.a)({},e,{isLoading:!0});case"GET_BOOKS_SUCCES":return Object(I.a)({},e,{isLoading:!1,books:t.payload});case"GET_BOOKS_ERROR":return Object(I.a)({},e,{isLoading:!1,error:t.payload});default:return e}},J=Object(F.c)({signInReducer:_,booksReducer:V}),M=Object(F.d)(J,Object(F.a)(K.a));c.a.render(r.a.createElement(s.a,{store:M},r.a.createElement(i.a,{basename:"/"},r.a.createElement(w,null))),document.getElementById("root"))}},[[42,1,2]]]);
//# sourceMappingURL=main.4cf0246b.chunk.js.map